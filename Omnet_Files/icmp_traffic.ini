[General]
network = FiveNodeNetwork
sim-time-limit = 300s

# ---------------- IPv4 Configuration ----------------
*.hasIpv4 = true
*.ipv4.arp.typename = "GlobalArp"
# Crucial: This allows the server to send Echo Replies back to the sender
**.ipv4.icmp.echoReply = true 

# ----------------- PCAP Configuration -----------------
**.fcsMode = "computed"
**.crcMode = "computed"
*.switch0.numPcapRecorders = 0

# ====================================================
# PCAP RECORDING (Saving the ICMP Traffic)
# ====================================================
*.server.numPcapRecorders = 1
*.server.pcapRecorder[0].pcapFile = "results/icmp_server_dataset.pcap"
*.server.pcapRecorder[0].moduleNamePatterns = "eth[*]"
*.server.pcapRecorder[0].alwaysFlush = true

*.attacker.numPcapRecorders = 1
*.attacker.pcapRecorder[0].pcapFile = "results/icmp_attacker_dataset.pcap"
*.attacker.pcapRecorder[0].moduleNamePatterns = "eth[*]"
*.attacker.pcapRecorder[0].alwaysFlush = true

# ====================================================
# SERVER APPLICATIONS
# ====================================================
*.server.numApps = 0 # Server doesn't need apps to respond to ICMP

# ====================================================
# CLIENT APPLICATIONS (Legitimate ICMP Traffic)
# ====================================================
*.client[*].numApps = 1
*.client[*].app[0].typename = "PingApp"
*.client[*].app[0].destAddr = "server"
*.client[*].app[0].startTime = uniform(1s, 10s)
*.client[*].app[0].sendInterval = 1s         # Normal 1Hz ping
*.client[*].app[0].packetSize = 56B          # Standard Linux ping size
*.client[*].app[0].printPing = true

# ====================================================
# ATTACKER APPLICATIONS (ICMP PING FLOOD)
# ====================================================
*.attacker.numApps = 1

# 1. ICMP Flood (Starts @ 50s)
*.attacker.app[0].typename = "PingApp"
*.attacker.app[0].destAddr = "server"
*.attacker.app[0].startTime = 50s
*.attacker.app[0].stopTime = 250s
*.attacker.app[0].sendInterval = 0.0005s    # 2,000 packets per second
*.attacker.app[0].packetSize = 1450B        # Large MTU-filling packets
*.attacker.app[0].printPing = false         # Disable console logging to save RAM