[General]
network = FiveNodeNetwork
sim-time-limit = 300s

# ---------------- IPv4 Configuration ----------------
*.hasIpv4 = true
*.ipv4.arp.typename = "GlobalArp"

# ----------------- PCAP Configuration -----------------
**.fcsMode = "computed"
**.crcMode = "computed"

# 3. Disable PCAP on the switch to prevent conflicts
*.switch0.numPcapRecorders = 0
# ----------------------------------------------------------------

# Output and Signal Recording
output-vector-file = "results/packets.vec"
output-scalar-file = "results/scalars.sca"
**.packetReceived.record = true
**.packetSent.record = true
**.packetDropped.record = true

# ====================================================
# PCAP RECORDING (Research Dataset Generation)
# ====================================================
*.server.numPcapRecorders = 1
*.server.pcapRecorder[0].pcapFile = "results/nids_server_dataset.pcap"
*.server.pcapRecorder[0].moduleNamePatterns = "eth[*]"
*.server.pcapRecorder[0].alwaysFlush = true

*.attacker.numPcapRecorders = 1
*.attacker.pcapRecorder[0].pcapFile = "results/nids_attacker_dataset.pcap"
*.attacker.pcapRecorder[0].moduleNamePatterns = "eth[*]"
*.attacker.pcapRecorder[0].alwaysFlush = true

# ====================================================
# SERVER APPLICATIONS (ONLY SSH)
# ====================================================
*.server.numApps = 1  # Only one app for SSH (port 22)
*.server.app[0].typename = "TcpGenericServerApp"
*.server.app[0].localPort = 22  # SSH Port
*.server.app[0].replyBytes = int(truncnormal(500B, 200B))

# ====================================================
# CLIENT APPLICATIONS (Legitimate SSH Traffic)
# ====================================================
*.client[*].numApps = 1 
*.client[*].app[0].typename = "TcpBasicClientApp"
*.client[*].app[0].connectAddress = "server"
*.client[*].app[0].connectPort = 22  # SSH Port
*.client[*].app[0].requestLength = int(truncnormal(800B, 200B))
*.client[*].app[0].replyLength = int(truncnormal(2000B, 500B))
*.client[*].app[0].startTime = uniform(1s, 5s)

# ====================================================
# ATTACKER APPLICATIONS (The GAN Dataset Source for SSH-related Attacks)
# ====================================================
*.attacker.numApps = 61

# 1. SYN Flood (Starts @ 10s)
*.attacker.app[0..9].typename = "TcpBasicClientApp"
*.attacker.app[0..9].connectAddress = "server"
*.attacker.app[0..9].connectPort = 22  # SSH Port
*.attacker.app[0..9].requestLength = 64B
*.attacker.app[0..9].numRequestsPerSession = 1000
*.attacker.app[0..9].startTime = 10s

# 2. Port Scan (Starts @ 30s)
*.attacker.app[10..59].typename = "TcpBasicClientApp"
*.attacker.app[10..59].connectAddress = "server"
*.attacker.app[10..59].requestLength = 64B
*.attacker.app[10..59].numRequestsPerSession = 1
*.attacker.app[10..59].startTime = 30s + (index * 0.2s)
*.attacker.app[10..59].connectPort = 22  # SSH Port

# 3. UDP Flood (Starts @ 60s)
*.attacker.app[60].typename = "UdpBasicApp"
*.attacker.app[60].destAddresses = "server"
*.attacker.app[60].destPort = 5000
*.attacker.app[60].sendInterval = 1ms
*.attacker.app[60].messageLength = 1200B
*.attacker.app[60].startTime = 60s
